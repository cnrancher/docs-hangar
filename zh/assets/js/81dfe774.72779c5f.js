"use strict";(self.webpackChunkdocs_hangar=self.webpackChunkdocs_hangar||[]).push([[1109],{8453:(e,s,a)=>{a.d(s,{R:()=>c,x:()=>t});var n=a(6540);const r={},d=n.createContext(r);function c(e){const s=n.useContext(d);return n.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function t(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:c(e.components),n.createElement(d.Provider,{value:s},e.children)}},9200:(e,s,a)=>{a.r(s),a.d(s,{assets:()=>i,contentTitle:()=>t,default:()=>h,frontMatter:()=>c,metadata:()=>n,toc:()=>l});const n=JSON.parse('{"id":"save/save","title":"Save \u547d\u4ee4","description":"Save \u547d\u4ee4\u5c06\u955c\u50cf\u5217\u8868\u4e2d\u7684\u955c\u50cf\u4fdd\u5b58\u81f3\u672c\u5730\u6587\u4ef6\u4e2d\uff0c\u4f9b Load \u547d\u4ee4\u4f7f\u7528\u3002","source":"@site/i18n/zh/docusaurus-plugin-content-docs/version-v1.6/11-save/01-save.md","sourceDirName":"11-save","slug":"/save/save","permalink":"/zh/docs/v1.6/save/save","draft":false,"unlisted":false,"editUrl":"https://github.com/cnrancher/docs-hangar/edit/main/versioned_docs/version-v1.6/11-save/01-save.md","tags":[],"version":"v1.6","lastUpdatedAt":1739771998000,"sidebarPosition":1,"frontMatter":{"title":"Save \u547d\u4ee4"},"sidebar":"docs","previous":{"title":"Save","permalink":"/zh/docs/v1.6/save/"},"next":{"title":"Load","permalink":"/zh/docs/v1.6/load/"}}');var r=a(4848),d=a(8453);const c={title:"Save \u547d\u4ee4"},t=void 0,i={},l=[{value:"\u955c\u50cf\u5217\u8868\u683c\u5f0f",id:"\u955c\u50cf\u5217\u8868\u683c\u5f0f",level:2},{value:"QuickStart",id:"quickstart",level:2},{value:"Parameters",id:"parameters",level:2},{value:"Save \u539f\u7406",id:"save-\u539f\u7406",level:2},{value:"\u5206\u5377\u538b\u7f29",id:"\u5206\u5377\u538b\u7f29",level:2}];function o(e){const s={a:"a",blockquote:"blockquote",code:"code",h2:"h2",p:"p",pre:"pre",strong:"strong",...(0,d.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(s.p,{children:["Save \u547d\u4ee4\u5c06\u955c\u50cf\u5217\u8868\u4e2d\u7684\u955c\u50cf\u4fdd\u5b58\u81f3\u672c\u5730\u6587\u4ef6\u4e2d\uff0c\u4f9b ",(0,r.jsx)(s.a,{href:"/docs/v1.6/load/load",children:"Load"})," \u547d\u4ee4\u4f7f\u7528\u3002"]}),"\n",(0,r.jsx)(s.h2,{id:"\u955c\u50cf\u5217\u8868\u683c\u5f0f",children:"\u955c\u50cf\u5217\u8868\u683c\u5f0f"}),"\n",(0,r.jsxs)(s.p,{children:["Save \u547d\u4ee4\u7684\u955c\u50cf\u5217\u8868\u683c\u5f0f\u4e0e ",(0,r.jsx)(s.code,{children:"rancher-images.txt"})," \u683c\u5f0f\u4e00\u81f4\u3002"]}),"\n",(0,r.jsxs)(s.p,{children:["\u6bcf\u4e00\u884c\u5305\u542b ",(0,r.jsxs)(s.strong,{children:["\u201c\u955c\u50cf\u540d\u79f0",":TAG","\u201d"]}),"\uff0c\u955c\u50cf\u4e0e TAG \u4e4b\u95f4\u4ee5 ",(0,r.jsx)(s.code,{children:":"})," \u5206\u9694\uff0c\u4f8b\u5982\uff1a"]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-txt",children:"# <NAME>:<TAG>\nrancher/rancher:v2.7.0\n"})}),"\n",(0,r.jsxs)(s.blockquote,{children:["\n",(0,r.jsxs)(s.p,{children:["\u82e5\u8be5\u884c\u4ee5 ",(0,r.jsx)(s.code,{children:"#"})," \u6216 ",(0,r.jsx)(s.code,{children:"//"})," \u5f00\u5934\uff0c\u90a3\u4e48\u8fd9\u4e00\u884c\u5c06\u88ab\u89c6\u4e3a\u6ce8\u91ca"]}),"\n"]}),"\n",(0,r.jsx)(s.h2,{id:"quickstart",children:"QuickStart"}),"\n",(0,r.jsxs)(s.p,{children:["\u5c06 ",(0,r.jsx)(s.code,{children:"rancher-images.txt"})," \u5217\u8868\u4e2d\u7684\u6240\u6709\u955c\u50cf\u4e0b\u8f7d\u5230\u672c\u5730\u5e76\u521b\u5efa ",(0,r.jsx)(s.code,{children:"tar.gz"})," \u538b\u7f29\u5305\uff1a"]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-sh",children:"hangar save -f ./rancher-images.txt -d saved-images.tar.gz\n"})}),"\n",(0,r.jsxs)(s.blockquote,{children:["\n",(0,r.jsxs)(s.p,{children:["\u6b64\u547d\u4ee4\u4f1a\u5148\u5c06\u955c\u50cf\u4e0b\u8f7d\u81f3 ",(0,r.jsx)(s.code,{children:"saved-image-cache"})," \u7f13\u5b58\u6587\u4ef6\u5939\u5185\uff0c\u4e4b\u540e\u5bf9\u6b64\u6587\u4ef6\u5939\u521b\u5efa\u538b\u7f29\u5305\u3002"]}),"\n"]}),"\n",(0,r.jsxs)(s.p,{children:["\u4f7f\u7528 ",(0,r.jsx)(s.code,{children:"--compress"})," \u53c2\u6570\uff0c\u6307\u5b9a\u4fdd\u5b58\u5230\u672c\u5730\u7684\u6587\u4ef6\u7684\u538b\u7f29\u683c\u5f0f\uff08\u6216\u662f\u5426\u8fdb\u884c\u538b\u7f29\uff09\u3002"]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-sh",children:"# \u538b\u7f29\u683c\u5f0f\u4e3a zstd\nhangar save -f ./rancher-images.txt -d saved-images.tar.zstd --compress=zstd\n\n# \u4e0d\u8fdb\u884c\u538b\u7f29\nhangar save -f ./rancher-images.txt -d saved-images --compress=dir\n"})}),"\n",(0,r.jsxs)(s.p,{children:["\u4f7f\u7528 ",(0,r.jsx)(s.code,{children:"--arch"})," \u548c ",(0,r.jsx)(s.code,{children:"--os"})," \u53c2\u6570\uff0c\u6307\u5b9a\u4fdd\u5b58\u955c\u50cf\u7684\u67b6\u6784 & \u7cfb\u7edf\u3002"]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-sh",children:"# \u4ec5\u4fdd\u5b58 amd64 \u67b6\u6784\u7684 linux \u955c\u50cf\nhangar save -f ./rancher-images.txt -d saved-images.tar.gz --arch=amd64 --os=linux\n"})}),"\n",(0,r.jsx)(s.h2,{id:"parameters",children:"Parameters"}),"\n",(0,r.jsx)(s.p,{children:"\u547d\u4ee4\u884c\u53c2\u6570\uff1a"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-sh",children:"# \u4f7f\u7528 -f, --file \u53c2\u6570\u6307\u5b9a\u955c\u50cf\u5217\u8868\u6587\u4ef6\nhangar save -f ./list.txt\n\n# \u4f7f\u7528 -d, --destination \u53c2\u6570\uff0c\u6307\u5b9a\u4fdd\u5b58\u7684\u955c\u50cf\u7684\u6587\u4ef6\u540d\u79f0\n# (\u53ef\u914d\u5408 --compress \u53c2\u6570\u6307\u5b9a\u76ee\u6807\u6587\u4ef6\u7684\u683c\u5f0f)\n# \u9ed8\u8ba4\u6587\u4ef6\u540d\u4e3a saved-images.tar.gz\nhangar save -f ./list.txt -d saved-images.tar.gz\n\n# \u4f7f\u7528 -s, --source \u53c2\u6570\uff0c\u53ef\u5728\u4e0d\u4fee\u6539\u955c\u50cf\u5217\u8868\u7684\u60c5\u51b5\u4e0b\uff0c\u6307\u5b9a\u6e90\u955c\u50cf\u7684 registry\n# \u5982\u679c\u955c\u50cf\u5217\u8868\u4e2d\u7684\u6e90\u955c\u50cf\u6ca1\u6709\u5199 registry\uff0c\u4e14\u672a\u8bbe\u5b9a -s \u53c2\u6570\uff0c\u90a3\u4e48\u6e90\u955c\u50cf\u7684 registry \u4f1a\u88ab\u8bbe\u5b9a\u4e3a\u9ed8\u8ba4\u7684 docker.io\nhangar save -f ./list.txt -s custom.registry.io -d saved-images.tar.gz\n\n# \u4f7f\u7528 -a, --arch \u53c2\u6570\uff0c\u6307\u5b9a\u5bfc\u51fa\u7684\u955c\u50cf\u7684\u67b6\u6784\uff08\u4ee5\u9017\u53f7\u5206\u9694\uff09\n# \u9ed8\u8ba4\u4e3a amd64,arm64\nhangar save -f ./list.txt -a amd64,arm64 -d saved-images.tar.gz\n\n# \u4f7f\u7528 --os \u53c2\u6570\uff0c\u8bbe\u5b9a\u955c\u50cf\u7684 OS\uff08\u4ee5\u9017\u53f7\u5206\u9694\uff09\n# \u9ed8\u8ba4\u4e3a linux,windows\nhangar save -f ./list.txt --os linux -d saved-images.tar.gz\n\n# \u4f7f\u7528 --no-arch-os-fail \u53c2\u6570\n# \u82e5\u955c\u50cf\u6240\u652f\u6301\u7684\u67b6\u6784\u4e0d\u5728 --arch \u53c2\u6570\u6240\u63d0\u4f9b\u7684\u67b6\u6784\u5217\u8868\u5185\uff0c\u4e14\u955c\u50cf\u7684 OS \u4e0d\u5728 --os \u53c2\u6570\u6240\u63d0\u4f9b\u7684\u7cfb\u7edf\u5217\u8868\u5185\uff0c\n# \u5219\u5c06\u5176\u89c6\u4e3a\u955c\u50cf Save \u5931\u8d25\uff0c\u5e76\u8f93\u51fa\u9519\u8bef\u65e5\u5fd7\u3002\n# \u9ed8\u8ba4\u4e3a false \uff08\u4ec5\u8f93\u51fa Warn \u4fe1\u606f\uff0c\u4e0d\u89c6\u4e3a\u955c\u50cf Save \u5931\u8d25\uff09\nhangar save -f ./list.txt -a arm64 --no-arch-os-fail\n\n# \u4f7f\u7528 -j, --jobs \u53c2\u6570\uff0c\u6307\u5b9a Worker \u6570\u91cf\uff0c\u5e76\u53d1\u4e0b\u8f7d\u955c\u50cf\u81f3\u672c\u5730\uff08\u652f\u6301 1~20 \u4e2a jobs\uff09\nhangar save -f ./list.txt -d saved-images.tar.gz -j 10 # \u542f\u52a8 10 \u4e2a Worker\n\n# \u4f7f\u7528 --part \u53c2\u6570\uff0c\u542f\u7528\u5206\u5377\u538b\u7f29\uff0c\u9ed8\u8ba4\u6bcf\u4e2a\u5377\u7684\u5927\u5c0f\u4e3a 2G\n# \u53ef\u4f7f\u7528 --part-size \u53c2\u6570\u8bbe\u5b9a\u5377\u5927\u5c0f\n# \u5f00\u542f\u5206\u5377\u538b\u7f29\u540e\uff0c\u5c06\u521b\u5efa\u4ee5 .partX \u4e3a\u540e\u7f00\u7684\u6587\u4ef6\nhangar save -f ./list.txt -d saved-images.tar.gz --part --part-size=4G # \u6307\u5b9a\u6bcf\u4e2a\u5206\u7247\u4f53\u79ef\u6700\u5927\u4e3a 4G\n\n# \u4f7f\u7528 -o, --output \u53c2\u6570\uff0c\u5c06 save \u5931\u8d25\u7684\u955c\u50cf\u5217\u8868\u8f93\u51fa\u81f3\u6307\u5b9a\u6587\u4ef6\u4e2d\n# \u9ed8\u8ba4\u8f93\u51fa\u81f3 save-failed.txt\nhangar save -f image-list.txt -o failed-list.txt\n\n# \u4f7f\u7528 --compress \u53c2\u6570\uff0c\u6307\u5b9a\u538b\u7f29\u683c\u5f0f/\u662f\u5426\u8fdb\u884c\u538b\u7f29\n# \u53ef\u9009\uff1agzip, zstd, dir\n# \u9ed8\u8ba4\u4e3a gzip \u683c\u5f0f\uff0c\u82e5\u4e3a dir \u683c\u5f0f\u5219\u8868\u793a\u53ea\u5c06 save \u7684\u955c\u50cf\u4fdd\u5b58\u5728\u6587\u4ef6\u5939\u4e2d\uff0c\u4e0d\u5bf9\u5176\u8fdb\u884c\u538b\u7f29\uff08\u91cd\u547d\u540d\u6587\u4ef6\u5939\uff09\nhangar save -f image-list.txt --compress=zstd -d saved.tar.zstd\nhangar save -f image-list.txt --compress=dir -d saved-directory\n\n# \u82e5 Registry Server \u4e3a HTTP \u6216\u4f7f\u7528\u81ea\u7b7e\u540d TLS Certificate\uff0c\n# \u9700\u8981\u4f7f\u7528 --tls-verify=false \u53c2\u6570\uff0c\u8df3\u8fc7 Registry \u4ed3\u5e93\u7684 TLS \u9a8c\u8bc1\nhangar save -f ./list.txt --tls-verify=false\n\n# \u4f7f\u7528 --debug \u53c2\u6570\uff0c\u8f93\u51fa\u66f4\u8be6\u7ec6\u7684\u8c03\u8bd5\u65e5\u5fd7\nhangar save -f ./list.txt --debug\n"})}),"\n",(0,r.jsx)(s.h2,{id:"save-\u539f\u7406",children:"Save \u539f\u7406"}),"\n",(0,r.jsxs)(s.blockquote,{children:["\n",(0,r.jsx)(s.p,{children:(0,r.jsxs)(s.strong,{children:["Hangar Save \u547d\u4ee4\u521b\u5efa\u7684\u538b\u7f29\u5305\u4e0e ",(0,r.jsx)(s.code,{children:"docker save"})," \u521b\u5efa\u7684\u538b\u7f29\u5305\u4e0d\u901a\u7528\u3002"]})}),"\n"]}),"\n",(0,r.jsxs)(s.p,{children:["Hangar \u5728\u6267\u884c Save \u65f6\uff0c\u9996\u5148\u5c06\u955c\u50cf\u5217\u8868\u4e2d\u7684\u955c\u50cf\u7684 ",(0,r.jsx)(s.code,{children:"blobs"})," \u4f7f\u7528 ",(0,r.jsx)(s.code,{children:"skopeo copy"})," \u4ee5 OCI \u683c\u5f0f\u4fdd\u5b58\u81f3\u672c\u5730\u7684 ",(0,r.jsx)(s.code,{children:"saved-image-cache"})," \u6587\u4ef6\u5939\u4e2d\u3002"]}),"\n",(0,r.jsxs)(s.p,{children:["\u955c\u50cf\u7684 ",(0,r.jsx)(s.code,{children:"blobs"})," \u6587\u4ef6\u4f1a\u4fdd\u5b58\u81f3 ",(0,r.jsx)(s.code,{children:"saved-image-cache/share"})," \u5171\u4eab\u6587\u4ef6\u5939\u5185\u3002"]}),"\n",(0,r.jsxs)(s.p,{children:["\u5f85\u6240\u6709\u955c\u50cf\u4e0b\u8f7d\u5b8c\u6bd5\u540e\uff0cHangar \u4f1a\u5bf9 ",(0,r.jsx)(s.code,{children:"saved-image-cache"})," \u521b\u5efa\u538b\u7f29\u5305\uff08\u4f7f\u7528 ",(0,r.jsx)(s.code,{children:"--compress=dir"})," \u53c2\u6570\u9664\u5916\uff09\u3002"]}),"\n",(0,r.jsxs)(s.p,{children:["\u521b\u5efa\u5b8c\u538b\u7f29\u5305\u540e\uff0cHangar \u4e0d\u4f1a\u81ea\u52a8\u5220\u9664 ",(0,r.jsx)(s.code,{children:"saved-image-cache"})," \u6587\u4ef6\u5939\uff0c\u8bf7\u624b\u52a8\u5220\u9664\u6b64\u6587\u4ef6\u5939\u4ee5\u8282\u7701\u786c\u76d8\u7a7a\u95f4\u3002"]}),"\n",(0,r.jsxs)(s.blockquote,{children:["\n",(0,r.jsxs)(s.p,{children:["\u53ef\u4f7f\u7528 ",(0,r.jsx)(s.a,{href:"../advanced/sync",children:"sync"})," \u4ee5\u53ca ",(0,r.jsx)(s.a,{href:"../advanced/compress",children:"compress"})," \u547d\u4ee4\u5bf9 cache \u6587\u4ef6\u5939\u6dfb\u52a0\u955c\u50cf/\u6267\u884c\u538b\u7f29\u64cd\u4f5c\u3002"]}),"\n"]}),"\n",(0,r.jsx)(s.h2,{id:"\u5206\u5377\u538b\u7f29",children:"\u5206\u5377\u538b\u7f29"}),"\n",(0,r.jsxs)(s.p,{children:["\u53ef\u4f7f\u7528 ",(0,r.jsx)(s.code,{children:"--part"})," \u53c2\u6570\u542f\u7528\u5206\u5377\u538b\u7f29\uff0c\u5e76\u4f7f\u7528 ",(0,r.jsx)(s.code,{children:"--part-size"})," \u53c2\u6570\u6307\u5b9a\u5377\u5927\u5c0f\uff0c\u8be5\u53c2\u6570\u652f\u6301\u7eaf\u6570\u5b57\uff08\u8868\u793a\u5b57\u8282\u5927\u5c0f\uff09\u6216\u4ee5",(0,r.jsx)(s.code,{children:"K"}),"\u3001",(0,r.jsx)(s.code,{children:"M"}),"\u3001",(0,r.jsx)(s.code,{children:"G"}),"\u5b57\u6bcd\u7ed3\u5c3e\u7684\u6570\u503c\u3002"]}),"\n",(0,r.jsxs)(s.p,{children:["\u542f\u7528\u5206\u5377\u538b\u7f29\u540e\uff0c\u521b\u5efa\u7684\u538b\u7f29\u5305\u6587\u4ef6\u5c06\u4ee5 ",(0,r.jsx)(s.code,{children:".partX"})," \u540e\u7f00\u7ed3\u5c3e\u3002"]}),"\n",(0,r.jsxs)(s.p,{children:["\u672c\u5de5\u5177\u521b\u5efa\u7684\u5206\u5377\u538b\u7f29\u7684\u539f\u7406\u4e0e Linux \u547d\u4ee4 ",(0,r.jsx)(s.code,{children:"split"})," \u4e00\u81f4\uff0c\u9664\u4e86\u53ef\u4f7f\u7528\u672c\u5de5\u5177\u7684 ",(0,r.jsx)(s.code,{children:"load"})," \u547d\u4ee4\u89e3\u538b\u5916\uff0c\u8fd8\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u5bf9\u5206\u5377\u538b\u7f29\u5305\u8fdb\u884c\u89e3\u538b\uff1a"]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-sh",children:"# \u5c06\u6240\u6709\u5206\u5377\u6574\u5408\ncat ./saved-images.tar.gz.part* > saved-images.tar.gz\n# \u5bf9\u6574\u5408\u540e\u7684\u538b\u7f29\u5305\u89e3\u538b\ntar -zxvf ./saved-images.tar.gz\n\n# \u6216\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u4e00\u952e\u89e3\u538b\ncat ./saved-images.tar.gz.part* | tar -zxv\n"})}),"\n",(0,r.jsxs)(s.blockquote,{children:["\n",(0,r.jsxs)(s.p,{children:["\u53ef\u4f7f\u7528\u955c\u50cf\u63a8\u9001\u5de5\u5177\u7684 ",(0,r.jsx)(s.code,{children:"load"})," \u547d\u4ee4\u914d\u5408 ",(0,r.jsx)(s.code,{children:"--compress=dir"})," \u53c2\u6570\uff0c\u4ece\u89e3\u538b\u540e\u7684\u7f13\u5b58\u6587\u4ef6\u5939\u4e2d\u52a0\u8f7d\u955c\u50cf\u4e0a\u4f20\u81f3\u79c1\u6709\u4ed3\u5e93\u3002"]}),"\n"]})]})}function h(e={}){const{wrapper:s}={...(0,d.R)(),...e.components};return s?(0,r.jsx)(s,{...e,children:(0,r.jsx)(o,{...e})}):o(e)}}}]);